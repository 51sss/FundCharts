/*!
 * 
 *   FundCharts
 *   @description: 移动端轻量级canvas数据可视化组件。折线图、饼图(环形图)、柱状图。
 *   @version: beta
 *   @author: Micheal Wayne(michealwayne@163.com)
 *   @build time: 2018-11-22
 * 
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FundCharts=e():t.FundCharts=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,i){"use strict";function n(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function r(t,e,i,r,a,o){if(!t)return!1;o=void 0===o?5:o;var s=n(r-e,a-i),h=Math.floor(s/o);t.beginPath();for(var c=0;c<h;c++)t[c%2==0?"moveTo":"lineTo"](e+(r-e)/h*c,i+(a-i)/h*c);t.closePath(),t.stroke()}function a(t,e){var i=window.devicePixelRatio||1;if(1===i)return!1;var n=t.height,r=t.width;return t.height=n*i,t.width=r*i,e.scale(i,i),t.style.height=n+"px",t.style.width=r+"px",i}function o(t){if(!t||!t.$el)throw new Error("Error! no chart object to set context.(FundChart)");var e=t.$el;e.style.webkitUserSelect="none",e.style.userSelect="none";var i=document.createElement("canvas");i.id=t.opts.id+"Canvas",i.width=(0,s.getStyle)(e,"width"),i.height=(0,s.getStyle)(e,"height"),e.appendChild(i),t.canvas=i,t.ctx=i.getContext("2d"),t._chart={width:i.width,height:i.height}}e.__esModule=!0,e.drawDashLine=r,e.retinaScale=a,e.setContext=o;var s=i(6)},function(t,e,i){"use strict";function n(t){return Object.prototype.toString.call(t).replace(/\[object\s|\]/g,"")}function r(t){return"Array"===n(t)}function a(t){return"String"===n(t)}function o(t){return"Object"===n(t)}function s(t){return"Function"===n(t)}function h(t,e){for(var i=0,n=t.length;i<n;i++)e(t[i],i)}function c(t,e){if(!o(t)||!o(e))return!1;for(var i in t)!o(e[i])||l[i]?e[i]=e[i]||t[i]:c(t[i],e[i]);return e}function l(t){if(!t)return!1;for(var e in t)return!1;return!0}function u(t){var e=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,i=t.toLowerCase();if(i&&e.test(i)){if(4===i.length){for(var n="#",r=1;r<4;r++)n+=i.slice(r,r+1).concat(i.slice(r,r+1));i=n}for(var a=[],o=1;o<7;o+=2)a.push(parseInt("0x"+i.slice(o,o+2)));return a}return i}e.__esModule=!0,e.type=n,e.isArray=r,e.isString=a,e.isObject=o,e.isFunction=s,e.each=h,e.cloneObjDeep=c,e.isEmptyObj=l,e.getColorRgb=u;e.cloneArray=function(t,e){return t.map(function(t,i){e[i]=t}),e}},function(t,e,i){"use strict";function n(t){function e(o){if(null===o)return t.onProcess&&t.onProcess(1),void(t.onAnimationFinish&&t.onAnimationFinish());if(null===a&&(a=o),o-a<t.duration){var s=(o-a)/t.duration;s=(0,r[t.timing])(s),t.onProcess&&t.onProcess(s),n(e,i)}else t.onProcess&&t.onProcess(1),t.onAnimationFinish&&t.onAnimationFinish()}t.duration=void 0===t.duration?1e3:t.duration,t.timing=t.timing||"linear";var i=23,n=o(),a=null;n(e,i)}e.__esModule=!0,e.Animation=n;var r={easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},linear:function(t){return t}},a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,o=function(){return void 0!==a?a:"undefined"!=typeof setTimeout?function(t,e){setTimeout(function(){var e=+new Date;t(e)},e)}:function(t){t(null)}}},function(t,e,i){"use strict";t.exports={background:"#fff",line:{colors:["#fe5d4e","#43c2f7"]},pie:{colors:["#fe5d4e","#43c2f7","#707ad9","#3ba8ff","#ffa92f"]},bar:{margin:60,colors:["#fe5d4e","#43c2f7","#707ad9","#3ba8ff","#ffa92f"]},dash:{color:"#e2e2e2",length:3},font:{color:"#666",fontSize:{x:"12px",y:"10px"}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var r=i(5),a=n(r),o=i(8),s=n(o),h=i(10),c=n(h);t.exports={line:a.default,pie:s.default,bar:c.default}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(1),a=i(0),o=i(7),s=function(t){return t&&t.__esModule?t:{default:t}}(o),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t);var i=e.id;if(!i)throw new Error("Error!no container id in options.(FundChart)");this.$el=document.getElementById(i),this.opts=e}return t.prototype._retinaScale=function(){var t=this.canvas,e=this.ctx;(0,a.retinaScale)(t,e)},t.prototype.update=function(t){if(!t)return!1;this.opts=(0,r.cloneObjDeep)(this.opts,t),this.drawer.draw(!0)},t.prototype.init=function(){(0,a.setContext)(this),this._retinaScale(),this.drawer=new s.default(this),this.drawer.init()},t}();e.default=h},function(t,e,i){"use strict";function n(t,e){var i=t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):void 0}e.__esModule=!0,e.getStyle=n},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(1),a=i(2),o=i(0),s=i(3),h=function(t){return t&&t.__esModule?t:{default:t}}(s),c=function(){function t(e){if(n(this,t),!e)throw new Error("Error!no canvas element.(FundChart-draw)");this.chartjs=e;var i=this.chartjs.opts.colors;i&&(h.default.line.colors=i.concat(h.default.line.colors))}return t.prototype.clearCtn=function(t){var e=this.chartjs,i=e.ctx,n=e._chart.width,r=e._chart.height;i.beginPath(),t?i.rect(46,0,n,r-22):i.rect(0,0,n,r),i.fillStyle=h.default.background,i.fill(),i.closePath()},t.prototype.drawDashs=function(){var t=this.chartjs.ctx,e=this.chartjs._chart.width-13,i=this.chartjs._chart.height,n=(i-30)/4;t.lineWidth=0,t.strokeStyle=h.default.dash.color,t.beginPath();for(var r=0;r<5;r++)(0,o.drawDashLine)(t,50,r*n+5,e,r*n+5,h.default.dash.length);t.save()},t.prototype.setDataset=function(){var t=this,e=this.chartjs,i=e.opts,n=i.data,a=i.datas,o=void 0,s=void 0,h=void 0,c=void 0,l=i.range;if(l){if(void 0===l.min||void 0===l.max)throw new Error("Error! param range need min and max");h=l.min,c=l.max-l.min}else a?(e.multline=!0,(0,r.each)(a,function(t){var e=Math.min.apply(null,t),i=Math.max.apply(null,t);o=o&&o<e?o:e,s=s&&s>i?s:i})):(o=Math.min.apply(null,n),s=Math.max.apply(null,n)),c=s-o,c>2?c=4*Math.ceil(c/4):c*=1.2,(h=c>2?Math.floor(o):o)+c<s&&(h=o);this.yaxis={min:h,max:h+c,range:c,unit:c/4},this.yRate=(30-e._chart.height)/this.yaxis.range,this.yBasic=5-this.yaxis.max*this.yRate;var u=n?n.length:a[0].length;if(this.xaxis={min:0,max:u-1,range:u,unit:1},this.xRate=(e._chart.width-65)/(u-1),this.xBasic=50,e.multline){var f=[];(0,r.each)(a,function(e){for(var i=[],n=0,r=e.length;n<r;n++)i.push({x:n*t.xRate+t.xBasic,y:e[n]*t.yRate+t.yBasic,value:e[n]});f.push(i)}),this.chartjs.datasets=f}else{var d=[];(0,r.each)(n,function(e,i){d.push({x:i*t.xRate+t.xBasic,y:n[i]*t.yRate+t.yBasic,value:n[i]})}),this.chartjs.dataset=d}},t.prototype.drawTexts=function(){var t=this.chartjs.ctx,e=this.chartjs.opts.xaxis,i=this.chartjs._chart.width,n=this.chartjs._chart.height;t.lineWidth=1,t.textAlign="right",t.font=h.default.font.fontSize.y+" Arial",t.fillStyle=h.default.font.color,t.fillText(e[e.length-1],i-15,n-10),t.textAlign="left",t.fillText(e[0],50,n-10),t.font="${Config.font.fontSize.x} Arial",t.textAlign="right",t.textBaseline="middle";for(var r=this.yaxis,a=0;a<5;a++){var o=r.min+a*r.unit;t.fillText(this.chartjs.opts.yaxisfunc?this.chartjs.opts.yaxisfunc(o):o.toFixed(2),45,this.yRate*o+this.yBasic)}},t.prototype.drawLine=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=this.chartjs.ctx;i.lineWidth=1;var n=this.chartjs._chart.height-24,a=function(e){if(t.chartjs.opts.noGradient)return!1;var n=i.createLinearGradient(0,0,0,170),a=(0,r.getColorRgb)(e);n.addColorStop(0,"rgba("+a.join(",")+", 0.3)"),n.addColorStop(.8,"rgba("+a.join(",")+", 0.1)"),n.addColorStop(1,"rgba("+a.join(",")+", 0.05)"),i.fillStyle=n,i.fill()};if(this.chartjs.multline){var o=this.chartjs.datasets;(0,r.each)(o,function(s,c){if(0===c){i.beginPath(),i.lineWidth=0,i.strokeStyle=h.default.background,i.moveTo(50,t.chartjs._chart.height-24);for(var l=0;l<o[0].length;l++)i.lineTo(o[c][l].x,n*(1-e)+o[c][l].y*e);i.lineTo(o[0][o[0].length-1].x,n),i.closePath(),a(h.default.line.colors[c]),i.stroke()}i.lineWidth=1,i.strokeStyle=h.default.line.colors[c],i.beginPath(),i.moveTo(o[c][0].x,n*(1-e)+o[c][0].y*e),(0,r.each)(o[c],function(t){i.lineTo(t.x,n*(1-e)+t.y*e)}),i.stroke()})}else{var s=this.chartjs.dataset;i.beginPath(),i.lineWidth=0,i.strokeStyle=h.default.background,i.moveTo(50,this.chartjs._chart.height-24);for(var c=0,l=s.length;c<l;c++)i.lineTo(s[c].x,n*(1-e)+s[c].y*e);i.lineTo(s[s.length-1].x,n),i.closePath(),a(h.default.line.colors[0]),i.stroke(),i.strokeStyle=h.default.line.colors[0],i.beginPath(),i.moveTo(s[0].x,n*(1-e)+s[0].y*e),(0,r.each)(s,function(t){i.lineTo(t.x,n*(1-e)+t.y*e)}),i.stroke()}i.save()},t.prototype.drawPoint=function(t,e,i,n){var r=this.chartjs.ctx;r.beginPath(),r.strokeStyle=n||"#fff",r.lineWidth=1,r.arc(t,e,4,0,2*Math.PI,!0),r.closePath(),r.fillStyle=i,r.fill(),r.stroke()},t.prototype.drawHover=function(t){var e=this;this.draw(null,!0);var i=this.chartjs.ctx;if(t>this.chartjs._chart.width-15||t<50)return!1;var n=Math.round((t-this.xBasic)/this.xRate),a=[],o=void 0,s=[];if(this.chartjs.multline){var c=this.chartjs.datasets;(0,r.each)(c,function(t,i){e.chartjs.opts.hideHoverPoints||s.push(function(){e.drawPoint(t[n].x,t[n].y-1,h.default.line.colors[i])}),o=t[n].x,a.push(t[n].value)})}else{var l=this.chartjs.dataset;this.chartjs.opts.hideHoverPoints||s.push(function(){e.drawPoint(l[n].x,l[n].y-1,h.default.line.colors[0])}),o=l[n].x,a.push(l[n].value)}i.lineWidth=1,i.strokeStyle="#999",i.beginPath(),i.moveTo(o,6),i.lineTo(o,this.chartjs._chart.height-25),i.stroke(),s.length&&_.fn.each(s,function(t){t()}),this.chartjs.opts.hover&&this.chartjs.opts.hover(n,a,this.chartjs.opts.xaxis[n]),i.restore()},t.prototype.setEvents=function(){var t=this,e=this.chartjs.canvas;e.addEventListener("touchstart",function(e){var i=e.touches[0].clientX;t.drawHover(i)},!1),e.addEventListener("touchmove",function(e){var i=e.touches[0].clientX;return t.drawHover(i),!1},!1)},t.prototype.draw=function(t,e){var i=this;this.clearCtn(!t),this.drawDashs(),t&&(this.setDataset(),this.drawTexts()),e?this.drawLine():(0,a.Animation)({timing:"easeInOut",duration:400,onProcess:function(t){i.clearCtn(!0),i.drawDashs(),i.drawLine(t)},onAnimationFinish:function(){console.log("chart finish")}})},t.prototype.init=function(){this.draw(!0),this.chartjs.opts.noHoverEvent||this.setEvents()},t}();e.default=c},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(9),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(0),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t);var i=e.id;if(!i)throw new Error("Error!no container id in options.(FundChart)");this.$el=document.getElementById(i),e.colors=e.colors||[],this.opts=e}return t.prototype._retinaScale=function(){var t=this.canvas,e=this.ctx;(0,o.retinaScale)(t,e)},t.prototype.init=function(){(0,o.setContext)(this),this._retinaScale(),this.drawer=new a.default(this),this.drawer.init()},t}();e.default=s},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(3),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(2),s=a.default.pie.colors,h=function(){function t(e){if(n(this,t),!e)throw new Error("Error!no canvas element.(FundChart-draw)");this.chartjs=e}return t.prototype.clearCtn=function(t){var e=this.chartjs.ctx;e.beginPath(),t?e.rect(46,0,this.chartjs._chart.width,this.chartjs._chart.height-22):e.rect(0,0,this.chartjs._chart.width,this.chartjs._chart.height),e.fillStyle=a.default.background,e.fill(),e.closePath()},t.prototype.drawPie=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e=e.concat(s),this.clearCtn();var r=this.chartjs.ctx;i=i>.9&&.9||i;var a=this.chartjs._chart.height/2-20,o=a*i,h=this.chartjs.opts.origin||{x:this.chartjs._chart.width/2,y:a+20},c=h.x,l=h.y,u=-.5*Math.PI,f=-.5*Math.PI;for(var d in t)f+=2*t[d]*Math.PI*n,r.fillStyle=e[d]&&~e[d].indexOf("#")?e[d]:s[d],r.beginPath(),r.moveTo(c,l),r.arc(c,l,a,u,f,!1),r.closePath(),r.fill(),u=f;r.fillStyle="#fff",r.beginPath(),r.moveTo(c,l),o&&r.arc(c,l,o,0,2*Math.PI,!1),r.closePath(),r.fill()},t.prototype.init=function(){var t=this,e=this.chartjs.opts;(0,o.Animation)({timing:"easeInOut",duration:600,onProcess:function(i){t.drawPie(e.datas,e.colors,e.annularRate,i)},onAnimationFinish:function(){console.log("pie chart finish")}})},t}();e.default=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(11),a=function(t){return t&&t.__esModule?t:{default:t}}(r),o=i(0),s=i(1),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t);var i=e.id;if(!i)throw new Error("Error!no container id in options.(FundChart)");this.$el=document.getElementById(i),e.colors=e.colors||[],this.opts=e}return t.prototype._retinaScale=function(){var t=this.canvas,e=this.ctx;this.pixelRatio=(0,o.retinaScale)(t,e)},t.prototype.update=function(t){if(!t)return!1;this.opts=(0,s.cloneObjDeep)(this.opts,t),this.drawer.draw(!0)},t.prototype.init=function(){(0,o.setContext)(this),this._retinaScale(),this.drawer=new a.default(this),this.drawer.init()},t}();e.default=h},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=i(1),a=i(2),o=i(0),s=i(3),h=function(t){return t&&t.__esModule?t:{default:t}}(s),c=h.default.bar.margin,l=function(){function t(e){if(n(this,t),!e)throw new Error("Error!no canvas element.(FundChart-draw)");this.chartjs=e;var i=this.chartjs.opts.colors;i&&(h.default.line.colors=i.concat(h.default.line.colors))}return t.prototype.clearCtn=function(t){var e=this.chartjs,i=e.ctx,n=e._chart.width,r=e._chart.height;i.beginPath(),t?i.rect(46,0,n,r-22):i.rect(0,0,n,r),i.fillStyle=h.default.background,i.fill(),i.closePath()},t.prototype.drawDashs=function(){var t=this.chartjs.ctx,e=this.chartjs._chart.width-13,i=this.chartjs._chart.height,n=(i-30)/4;t.lineWidth=0,t.strokeStyle=h.default.dash.color,t.beginPath();for(var r=0;r<5;r++)(0,o.drawDashLine)(t,50,r*n+5,e,r*n+5,h.default.dash.length);t.save()},t.prototype.setDataset=function(){var t=this,e=this.chartjs,i=e.opts,n=i.series;if(!n||!n.length)throw new Error("Error! no series data.");var a=void 0,o=0,s=void 0,h=i.range;if(h){if(void 0===h.min||void 0===h.max)throw new Error("Error! param range need min and max");o=h.min,s=h.max-h.min}else n.length>1?(e.multline=!0,(0,r.each)(n,function(t){var e=Math.max.apply(null,t);a=a&&a>e?a:e})):a=Math.max.apply(null,n[0]),s=a-o,s=s>5?5*Math.ceil(s/5):Math.ceil(1.2*s);this.yaxis={min:o,max:o+s,range:s,unit:s/4},this.yRate=(30-e._chart.height)/this.yaxis.range,this.yBasic=5-this.yaxis.max*this.yRate;var l=n[0].length;c=e.opts.barMargin||l>=10&&40-4*(l-10)||c,c=c<0?0:c/this.chartjs.pixelRatio,this.xaxis={min:0,max:l-1,range:l,unit:1};var u=this.chartjs.barWidth=Math.floor((e._chart.width-65)/l-c);if(this.xRate=(e._chart.width-65)/(l+1),this.xBasic=c/2+50,e.multline){var f=[];(0,r.each)(n,function(e,i){for(var n=[],r=0,a=e.length;r<a;r++){var o=r*u+(r+.5)*c+50;n.push({x:o,y:e[r]*t.yRate+t.yBasic,value:e[r]})}f.push(n)}),this.chartjs.datasets=f}else{var d=[];(0,r.each)(n[0],function(e,i){var r=i*u+(i+.5)*c+50;d.push({x:r,y:e*t.yRate+t.yBasic,value:n[0][i]})}),this.chartjs.dataset=d}},t.prototype.wrapText=function(t,e,i,n,r,a){if("string"==typeof e&&"number"==typeof i&&"number"==typeof n){var o=t.canvas;void 0===r&&(r=o&&o.width||300),void 0===a&&(a=o&&parseInt(window.getComputedStyle(o).lineHeight)||parseInt(window.getComputedStyle(document.body).lineHeight));for(var s=e.split(""),h="",c=0;c<s.length;c++){var l=h+s[c];t.measureText(l).width>r&&c>0?(t.fillText(h,i,n),h=s[c],n+=a):h=l}t.fillText(h,i,n)}},t.prototype.drawTexts=function(){var t=this,e=this.chartjs.ctx,i=this.chartjs.opts.xaxis,n=this.chartjs._chart.height;e.lineWidth=1,e.font=h.default.font.fontSize.y+" Arial",e.fillStyle=h.default.font.color,e.textAlign="center";var a=this.chartjs.multline?this.chartjs.datasets[0]:this.chartjs.dataset,o=this.chartjs.barWidth;e.stroke();var s=2.5*o;a.length>=10&&(s=1.8*o),(0,r.each)(a,function(r,a){if(!i[a])return!1;t.wrapText(e,i[a],r.x+o/2,n-15,s,12)}),e.textAlign="right",e.textBaseline="middle";for(var c=this.yaxis,l=0;l<5;l++){var u=c.min+l*c.unit;e.fillText(this.chartjs.opts.yaxisfunc?this.chartjs.opts.yaxisfunc(u):u.toFixed(2),45,this.yRate*u+this.yBasic)}},t.prototype.drawBars=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=this.chartjs.ctx;i.lineWidth=1;var n=this.chartjs._chart.height-24;if(this.chartjs.multline){var a=this.chartjs.datasets;(0,r.each)(a,function(r,o){i.beginPath(),i.lineWidth=0,i.strokeStyle=h.default.background;for(var s=t.chartjs._chart.height-24,c=t.chartjs.barWidth/a.length,l=0,u=r.length;l<u;l++)i.fillStyle=h.default.bar.colors[o],i.fillRect(r[l].x+c*o,s,c,(r[l].y-n)*e+n-s);i.stroke()})}else{var o=this.chartjs.dataset;i.beginPath(),i.lineWidth=0,i.strokeStyle=h.default.background;for(var s=this.chartjs._chart.height-24,c=this.chartjs.barWidth,l=0,u=o.length;l<u;l++)i.fillStyle=h.default.bar.colors[0],i.fillRect(o[l].x,s,c,(o[l].y-n)*e+n-s);i.stroke()}i.save()},t.prototype.draw=function(t,e){var i=this;this.clearCtn(!t),this.drawDashs(),t&&(this.setDataset(),this.drawTexts()),e?this.drawBars():(0,a.Animation)({timing:"easeInOut",duration:800,onProcess:function(t){i.clearCtn(!0),i.drawDashs(),i.drawBars(t)},onAnimationFinish:function(){console.log("chart finish")}})},t.prototype.init=function(){this.draw(!0)},t}();e.default=l}])});